<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>MQTT-SN_Contiki: Referência ao ficheiro mqtt_sn.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_symbol.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MQTT-SN_Contiki
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Porte do MQTT-SN para o sistema operacional Contiki-OS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Gerado por Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Localizar');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="pages.html"><span>Páginas&#160;relacionadas</span></a></li>
      <li><a href="modules.html"><span>Módulos</span></a></li>
      <li><a href="annotated.html"><span>Estruturas&#160;de&#160;dados</span></a></li>
      <li class="current"><a href="files.html"><span>Ficheiros</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Localizar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>Lista&#160;de&#160;ficheiros</span></a></li>
      <li><a href="globals.html"><span>Globais</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Tudo</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Estruturas de dados</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Ficheiros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Funções</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variáveis</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Definições de tipos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerações</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Valores da enumeração</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Grupos</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Páginas</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Funções</a>  </div>
  <div class="headertitle">
<div class="title">Referência ao ficheiro mqtt_sn.c</div>  </div>
</div><!--header-->
<div class="contents">

<p>Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements.  
<a href="#details">Mais...</a></p>
<div class="textblock"><code>#include &quot;contiki.h&quot;</code><br />
<code>#include &quot;net/ip/uip.h&quot;</code><br />
<code>#include &quot;net/ipv6/uip-ds6.h&quot;</code><br />
<code>#include &quot;simple-udp.h&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="mqtt__sn_8h_source.html">mqtt_sn.h</a>&gt;</code><br />
<code>#include &quot;sys/timer.h&quot;</code><br />
<code>#include &quot;list.h&quot;</code><br />
<code>#include &quot;sys/ctimer.h&quot;</code><br />
<code>#include &quot;sys/etimer.h&quot;</code><br />
<code>#include &quot;stdint.h&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Diagrama de dependências de inclusão para mqtt_sn.c:</div>
<div class="dyncontent">
<div class="center"><img src="mqtt__sn_8c__incl.png" border="0" usemap="#mqtt__sn_8c" alt=""/></div>
<map name="mqtt__sn_8c" id="mqtt__sn_8c">
<area shape="rect" id="node8" href="mqtt__sn_8h.html" title="Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements..." alt="" coords="440,80,520,107"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Funções</h2></td></tr>
<tr class="memitem:a3d0423866ea0d39d4356fb107fcd256b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3d0423866ea0d39d4356fb107fcd256b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PROCESS</b> (mqtt_sn_main,&quot;[MQTT-SN] Processo inicial&quot;)</td></tr>
<tr class="separator:a3d0423866ea0d39d4356fb107fcd256b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2620f37584b501fde35e71806a78b35a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a2620f37584b501fde35e71806a78b35a">unlock_tasks</a> (void)</td></tr>
<tr class="memdesc:a2620f37584b501fde35e71806a78b35a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Libera opção de geração de tarefas.  <a href="#a2620f37584b501fde35e71806a78b35a">Mais...</a><br /></td></tr>
<tr class="separator:a2620f37584b501fde35e71806a78b35a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0cb1cb4ad61ca752d66b286f839d72b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ae0cb1cb4ad61ca752d66b286f839d72b">init_sub</a> (void *ptr)</td></tr>
<tr class="memdesc:ae0cb1cb4ad61ca752d66b286f839d72b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicia o evento de SUBSCRIBE.  <a href="#ae0cb1cb4ad61ca752d66b286f839d72b">Mais...</a><br /></td></tr>
<tr class="separator:ae0cb1cb4ad61ca752d66b286f839d72b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac598f98e844bfd5bbdb577099ddf06d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a> (uint8_t type, char **type_string)</td></tr>
<tr class="memdesc:ac598f98e844bfd5bbdb577099ddf06d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retorna a string de status correspondente.  <a href="#ac598f98e844bfd5bbdb577099ddf06d1">Mais...</a><br /></td></tr>
<tr class="separator:ac598f98e844bfd5bbdb577099ddf06d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd6d4e9304d00d28861751c22b146e4"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a9bd6d4e9304d00d28861751c22b146e4">mqtt_sn_check_status_string</a> (void)</td></tr>
<tr class="memdesc:a9bd6d4e9304d00d28861751c22b146e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checa o status da conexãoe em String.  <a href="#a9bd6d4e9304d00d28861751c22b146e4">Mais...</a><br /></td></tr>
<tr class="separator:a9bd6d4e9304d00d28861751c22b146e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a200e89a8fd400c652431bd505de6f827"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#aab2bca192b63f37bf4847be3686bca75">mqtt_sn_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a200e89a8fd400c652431bd505de6f827">mqtt_sn_check_status</a> (void)</td></tr>
<tr class="memdesc:a200e89a8fd400c652431bd505de6f827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checa o status da conexão MQTT-SN.  <a href="#a200e89a8fd400c652431bd505de6f827">Mais...</a><br /></td></tr>
<tr class="separator:a200e89a8fd400c652431bd505de6f827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a172afa34fe10ad1ee4ffc0d226b35b4d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a172afa34fe10ad1ee4ffc0d226b35b4d">mqtt_sn_check_rc</a> (uint8_t rc)</td></tr>
<tr class="memdesc:a172afa34fe10ad1ee4ffc0d226b35b4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia requisição de conexão ao broker MQTT-SN.  <a href="#a172afa34fe10ad1ee4ffc0d226b35b4d">Mais...</a><br /></td></tr>
<tr class="separator:a172afa34fe10ad1ee4ffc0d226b35b4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba0283cc8fadf24f2f04246c76e8cde"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#adba0283cc8fadf24f2f04246c76e8cde">mqtt_sn_get_qos_flag</a> (int8_t qos)</td></tr>
<tr class="memdesc:adba0283cc8fadf24f2f04246c76e8cde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gera a flag de nível QoS.  <a href="#adba0283cc8fadf24f2f04246c76e8cde">Mais...</a><br /></td></tr>
<tr class="separator:adba0283cc8fadf24f2f04246c76e8cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5fde757ae886c8827b853125f7458bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ac5fde757ae886c8827b853125f7458bd">mqtt_sn_sub_wildcard</a> (char *topic, uint8_t qos)</td></tr>
<tr class="memdesc:ac5fde757ae886c8827b853125f7458bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepara tarefa de SUBSCRIBE do tipo WILDCARD.  <a href="#ac5fde757ae886c8827b853125f7458bd">Mais...</a><br /></td></tr>
<tr class="separator:ac5fde757ae886c8827b853125f7458bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8d5db0224c9b083af9f18094053795"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#aab8d5db0224c9b083af9f18094053795">mqtt_sn_sub</a> (char *topic, uint8_t qos)</td></tr>
<tr class="memdesc:aab8d5db0224c9b083af9f18094053795"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepara requisição de inscrição ao broker MQTT-SN.  <a href="#aab8d5db0224c9b083af9f18094053795">Mais...</a><br /></td></tr>
<tr class="separator:aab8d5db0224c9b083af9f18094053795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8c0f238b41b373afb8b21e0f594b79d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ab8c0f238b41b373afb8b21e0f594b79d">mqtt_sn_pub</a> (char *topic, char *message, bool retain_flag, uint8_t qos)</td></tr>
<tr class="memdesc:ab8c0f238b41b373afb8b21e0f594b79d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepara requisição de publicação ao broker MQTT-SN.  <a href="#ab8c0f238b41b373afb8b21e0f594b79d">Mais...</a><br /></td></tr>
<tr class="separator:ab8c0f238b41b373afb8b21e0f594b79d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60c0aa848adffbfe41a2e655a279f9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#af60c0aa848adffbfe41a2e655a279f9d">verf_hist_sub</a> (char *topic)</td></tr>
<tr class="memdesc:af60c0aa848adffbfe41a2e655a279f9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifica se o tópico já foi registrado.  <a href="#af60c0aa848adffbfe41a2e655a279f9d">Mais...</a><br /></td></tr>
<tr class="separator:af60c0aa848adffbfe41a2e655a279f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81a0d1e0daa51cdb8495a52e317e140"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ac81a0d1e0daa51cdb8495a52e317e140">verf_register</a> (char *topic)</td></tr>
<tr class="memdesc:ac81a0d1e0daa51cdb8495a52e317e140"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifica pré-registro do tópico.  <a href="#ac81a0d1e0daa51cdb8495a52e317e140">Mais...</a><br /></td></tr>
<tr class="separator:ac81a0d1e0daa51cdb8495a52e317e140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6674e1ecf45890d3a15ab667fe4a4f58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a6674e1ecf45890d3a15ab667fe4a4f58">print_g_topics</a> (void)</td></tr>
<tr class="memdesc:a6674e1ecf45890d3a15ab667fe4a4f58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exibe os tópicos registrados.  <a href="#a6674e1ecf45890d3a15ab667fe4a4f58">Mais...</a><br /></td></tr>
<tr class="separator:a6674e1ecf45890d3a15ab667fe4a4f58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada3c457ee81d0b29892742401845d918"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ada3c457ee81d0b29892742401845d918">init_vectors</a> (void)</td></tr>
<tr class="memdesc:ada3c457ee81d0b29892742401845d918"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicializa os vetores MQTT-SN.  <a href="#ada3c457ee81d0b29892742401845d918">Mais...</a><br /></td></tr>
<tr class="separator:ada3c457ee81d0b29892742401845d918"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb1174ee7cff21df2d0afbb6fe2db30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#adfb1174ee7cff21df2d0afbb6fe2db30">mqtt_sn_will_topic_send</a> (void)</td></tr>
<tr class="memdesc:adfb1174ee7cff21df2d0afbb6fe2db30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia tópico de LWT.  <a href="#adfb1174ee7cff21df2d0afbb6fe2db30">Mais...</a><br /></td></tr>
<tr class="separator:adfb1174ee7cff21df2d0afbb6fe2db30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6718f310e6635c018a7126c5b1311e50"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a6718f310e6635c018a7126c5b1311e50">mqtt_sn_will_message_send</a> (void)</td></tr>
<tr class="memdesc:a6718f310e6635c018a7126c5b1311e50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia mensagem de LWT.  <a href="#a6718f310e6635c018a7126c5b1311e50">Mais...</a><br /></td></tr>
<tr class="separator:a6718f310e6635c018a7126c5b1311e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af09083ea59a182fdf109b6e3fa213bec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#af09083ea59a182fdf109b6e3fa213bec">mqtt_sn_ping_send</a> (void)</td></tr>
<tr class="memdesc:af09083ea59a182fdf109b6e3fa213bec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia requisição de ping ao broker.  <a href="#af09083ea59a182fdf109b6e3fa213bec">Mais...</a><br /></td></tr>
<tr class="separator:af09083ea59a182fdf109b6e3fa213bec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b8eb51076a2923f2c036f1ff925c168"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a1b8eb51076a2923f2c036f1ff925c168">mqtt_sn_con_send</a> (void)</td></tr>
<tr class="memdesc:a1b8eb51076a2923f2c036f1ff925c168"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia requisição de conexão ao broker MQTT-SN.  <a href="#a1b8eb51076a2923f2c036f1ff925c168">Mais...</a><br /></td></tr>
<tr class="separator:a1b8eb51076a2923f2c036f1ff925c168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17664af7f894e29743fafdf8bf98f89"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ae17664af7f894e29743fafdf8bf98f89">mqtt_sn_reg_send</a> (void)</td></tr>
<tr class="memdesc:ae17664af7f894e29743fafdf8bf98f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envio de mensagens ao broker do tipo REGISTER.  <a href="#ae17664af7f894e29743fafdf8bf98f89">Mais...</a><br /></td></tr>
<tr class="separator:ae17664af7f894e29743fafdf8bf98f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6e0e9b8d7769407ab35fec5443e3896"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#aa6e0e9b8d7769407ab35fec5443e3896">mqtt_sn_regack_send</a> (uint16_t msg_id, uint16_t topic_id)</td></tr>
<tr class="memdesc:aa6e0e9b8d7769407ab35fec5443e3896"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia pacote do tipo REGACK ao broker.  <a href="#aa6e0e9b8d7769407ab35fec5443e3896">Mais...</a><br /></td></tr>
<tr class="separator:aa6e0e9b8d7769407ab35fec5443e3896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a550856b818c23fce9e4d5b253c3e7547"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a550856b818c23fce9e4d5b253c3e7547">mqtt_sn_pub_send</a> (char *topic, char *message, bool retain_flag, uint8_t qos)</td></tr>
<tr class="memdesc:a550856b818c23fce9e4d5b253c3e7547"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia pacote PUBLISH ao broker MQTT-SN.  <a href="#a550856b818c23fce9e4d5b253c3e7547">Mais...</a><br /></td></tr>
<tr class="separator:a550856b818c23fce9e4d5b253c3e7547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105b8d440266b4a582f2d627e57be14a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a105b8d440266b4a582f2d627e57be14a">mqtt_sn_sub_send</a> (char *topic, uint8_t qos)</td></tr>
<tr class="memdesc:a105b8d440266b4a582f2d627e57be14a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia pacote SUBSCRIBE ao broker MQTT-SN.  <a href="#a105b8d440266b4a582f2d627e57be14a">Mais...</a><br /></td></tr>
<tr class="separator:a105b8d440266b4a582f2d627e57be14a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a831d03a2cd7fbc884cec2013c2ebc823"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a831d03a2cd7fbc884cec2013c2ebc823">mqtt_sn_sub_send_wildcard</a> (char *topic, uint8_t qos)</td></tr>
<tr class="memdesc:a831d03a2cd7fbc884cec2013c2ebc823"><td class="mdescLeft">&#160;</td><td class="mdescRight">Envia pacote SUBSCRIBE do tipo WILDCARD ao broker MQTT-SN.  <a href="#a831d03a2cd7fbc884cec2013c2ebc823">Mais...</a><br /></td></tr>
<tr class="separator:a831d03a2cd7fbc884cec2013c2ebc823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade91c29dc851d7eef5fe46a9804b4d5e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ade91c29dc851d7eef5fe46a9804b4d5e"></a>
<a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>mqtt_sn_disconnect</b> (uint16_t duration)</td></tr>
<tr class="separator:ade91c29dc851d7eef5fe46a9804b4d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a575514d0f0fd3b6c5c4a2c75e604bf79"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a> (<a class="el" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a> new)</td></tr>
<tr class="memdesc:a575514d0f0fd3b6c5c4a2c75e604bf79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insere uma tarefa na fila.  <a href="#a575514d0f0fd3b6c5c4a2c75e604bf79">Mais...</a><br /></td></tr>
<tr class="separator:a575514d0f0fd3b6c5c4a2c75e604bf79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17781596362470e100d5fc4f62a01e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#aa17781596362470e100d5fc4f62a01e9">mqtt_sn_delete_queue</a> (void)</td></tr>
<tr class="memdesc:aa17781596362470e100d5fc4f62a01e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove o elemento mais próximo de ser processado.  <a href="#aa17781596362470e100d5fc4f62a01e9">Mais...</a><br /></td></tr>
<tr class="separator:aa17781596362470e100d5fc4f62a01e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4f357f3a8fa7a65fa95b695288c5173"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ae4f357f3a8fa7a65fa95b695288c5173">mqtt_sn_check_queue</a> (void)</td></tr>
<tr class="memdesc:ae4f357f3a8fa7a65fa95b695288c5173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lista as tarefas da fila.  <a href="#ae4f357f3a8fa7a65fa95b695288c5173">Mais...</a><br /></td></tr>
<tr class="separator:ae4f357f3a8fa7a65fa95b695288c5173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb698c97e10afa31e2c11351f6ce9388"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#afb698c97e10afa31e2c11351f6ce9388">mqtt_sn_check_empty</a> (void)</td></tr>
<tr class="memdesc:afb698c97e10afa31e2c11351f6ce9388"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checa o status da fila de tarefas MQTT-SN.  <a href="#afb698c97e10afa31e2c11351f6ce9388">Mais...</a><br /></td></tr>
<tr class="separator:afb698c97e10afa31e2c11351f6ce9388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9146fa082fe2bc6612fb13dbb20ed36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#af9146fa082fe2bc6612fb13dbb20ed36">mqtt_sn_recv_parser</a> (const uint8_t *data)</td></tr>
<tr class="memdesc:af9146fa082fe2bc6612fb13dbb20ed36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Realiza o parsing das mensagens UDP recebidas.  <a href="#af9146fa082fe2bc6612fb13dbb20ed36">Mais...</a><br /></td></tr>
<tr class="separator:af9146fa082fe2bc6612fb13dbb20ed36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6fc2a07c15881877943348bef786cd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ab6fc2a07c15881877943348bef786cd8">mqtt_sn_udp_rec_cb</a> (struct simple_udp_connection *c, const uip_ipaddr_t *sender_addr, uint16_t sender_port, const uip_ipaddr_t *receiver_addr, uint16_t receiver_port, const uint8_t *data, uint16_t datalen)</td></tr>
<tr class="memdesc:ab6fc2a07c15881877943348bef786cd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback de recepção UDP.  <a href="#ab6fc2a07c15881877943348bef786cd8">Mais...</a><br /></td></tr>
<tr class="separator:ab6fc2a07c15881877943348bef786cd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8771e78d9d8d5379ff27fba1feefe37c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a8771e78d9d8d5379ff27fba1feefe37c">mqtt_sn_create_sck</a> (<a class="el" href="structmqtt__sn__con__t.html">mqtt_sn_con_t</a> mqtt_sn_connection, char *topics[], size_t topic_len, <a class="el" href="mqtt__sn_8h.html#a679e4bebc7798d960960760150bdc5a7">mqtt_sn_cb_f</a> cb_f)</td></tr>
<tr class="memdesc:a8771e78d9d8d5379ff27fba1feefe37c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicia conexão ao broker UDP.  <a href="#a8771e78d9d8d5379ff27fba1feefe37c">Mais...</a><br /></td></tr>
<tr class="separator:a8771e78d9d8d5379ff27fba1feefe37c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46fe607d1db728d41ed6aec6fee3fc77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a46fe607d1db728d41ed6aec6fee3fc77">mqtt_sn_init</a> (void)</td></tr>
<tr class="memdesc:a46fe607d1db728d41ed6aec6fee3fc77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicializa PROCESS_THREAD MQTT-SN.  <a href="#a46fe607d1db728d41ed6aec6fee3fc77">Mais...</a><br /></td></tr>
<tr class="separator:a46fe607d1db728d41ed6aec6fee3fc77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9614aca44158215c43b8810e052939d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#ac9614aca44158215c43b8810e052939d">timeout_con</a> (void *ptr)</td></tr>
<tr class="memdesc:ac9614aca44158215c43b8810e052939d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processa timeout de pacotes.  <a href="#ac9614aca44158215c43b8810e052939d">Mais...</a><br /></td></tr>
<tr class="separator:ac9614aca44158215c43b8810e052939d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35dbd49b5fdc1d6e3dfe2b2d7255cf3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mqtt__sn_8c.html#a35dbd49b5fdc1d6e3dfe2b2d7255cf3e">timeout_ping_mqtt</a> (void *ptr)</td></tr>
<tr class="memdesc:a35dbd49b5fdc1d6e3dfe2b2d7255cf3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processa timeout de ping.  <a href="#a35dbd49b5fdc1d6e3dfe2b2d7255cf3e">Mais...</a><br /></td></tr>
<tr class="separator:a35dbd49b5fdc1d6e3dfe2b2d7255cf3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ada750a373f3b01262465d9b3dd468"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac4ada750a373f3b01262465d9b3dd468"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>PROCESS_THREAD</b> (mqtt_sn_main, ev, data)</td></tr>
<tr class="separator:ac4ada750a373f3b01262465d9b3dd468"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Descrição detalhada</h2>
<div class="textblock"><p>Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. </p>
<p>See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p>Este projeto está sendo liberado pela licença APACHE 2.0.</p>
<dl class="section author"><dt>Autor</dt><dd>Ânderson Ignácio da Silva </dd></dl>
<dl class="section date"><dt>Data</dt><dd>19 Ago 2016 Arquivo principal do código fonte do porte do MQTT-SN para o Contiki </dd></dl>
<dl class="section see"><dt>Veja também</dt><dd><a href="http://www.aignacio.com">http://www.aignacio.com</a></dd></dl>
<p>[Apontamento n-1]: Descoberta uma característica do contiki, o que ocorre é que se você utiliza algum temporizador de evento (etimer) e ele expira, ele gera um evento o que e esperado, porém se você tiver testando diversas condições de forma sequencial 1) else if(ev == etimer_expired(....)) 2) else if(ev == mqtt_event_regack) ... MESMO após ter gerado o evento de "expiração", caso a condição 1) esteja antes da 2), e a 2) que gerou um evento, a 1) será executada anteriormente porque compreendesse que o "timer continua expirado".</p>
<p>[Apontamento n-2]: Como nesta API utiliza-se malloc necessitamos da função do tipo POSIX chamadas "sbrk" a qual utiliza de chamadas de sistema para realizar a operação de aloca ção de memória.Logo, devemos incluir no arquivo principal o arquivo <a class="el" href="syscalls_8c.html" title="System calls. ">syscalls.c</a> (arquivo disponibilizado pelo contiki - lib/newlib/syscalls.c) e também deve- mos incluir as variáveis _heap e _eheap no linker script (cc26xx.ld) para a função sbrk saber onde começa e termina a zona heap de memória do mcu.</p>
<p>Incluir no linker: ... _heap = .; _eheap = ORIGIN(SRAM) + LENGTH(SRAM); } </p>
</div><h2 class="groupheader">Documentação das funções</h2>
<a class="anchor" id="ae0cb1cb4ad61ca752d66b286f839d72b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_sub </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicia o evento de SUBSCRIBE. </p>
<p>Inicia as requisições de inscrição através do evento</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna argumento </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;INICIANDO SUBSCRIBE&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  process_post(&amp;mqtt_sn_main,mqtt_event_run_task,NULL);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada3c457ee81d0b29892742401845d918"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_vectors </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicializa os vetores MQTT-SN. </p>
<p>Deleta tarefas na fila e inicializa o vetor de tópicos setando 0xFF aos identificadores de tópico</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna argumento </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                       {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Inicializando vetores...&quot;</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">for</span> (i = 1; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++){</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    g_topic_bind[i].short_topic_id = 0xFF;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    g_topic_bind[i].topic_name = 0;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    g_topic_bind[i].subscribed = 0x00;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="mqtt__sn_8c.html#afb698c97e10afa31e2c11351f6ce9388">mqtt_sn_check_empty</a>())</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="mqtt__sn_8c.html#aa17781596362470e100d5fc4f62a01e9">mqtt_sn_delete_queue</a>();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  g_task_id = 0;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_aa17781596362470e100d5fc4f62a01e9"><div class="ttname"><a href="mqtt__sn_8c.html#aa17781596362470e100d5fc4f62a01e9">mqtt_sn_delete_queue</a></div><div class="ttdeci">void mqtt_sn_delete_queue(void)</div><div class="ttdoc">Remove o elemento mais próximo de ser processado. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:669</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
<div class="ttc" id="mqtt__sn_8c_html_afb698c97e10afa31e2c11351f6ce9388"><div class="ttname"><a href="mqtt__sn_8c.html#afb698c97e10afa31e2c11351f6ce9388">mqtt_sn_check_empty</a></div><div class="ttdeci">bool mqtt_sn_check_empty(void)</div><div class="ttdoc">Checa o status da fila de tarefas MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:709</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb698c97e10afa31e2c11351f6ce9388"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mqtt_sn_check_empty </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checa o status da fila de tarefas MQTT-SN. </p>
<p>Percorra a lista encadeada de tarefas para verificar se está vazia</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>Fila vazia </td></tr>
    <tr><td class="paramname">FALSE</td><td>Há tarefas a serem processadas </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                              {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">if</span> (mqtt_queue_first  ==  NULL)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae4f357f3a8fa7a65fa95b695288c5173"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mqtt_sn_check_queue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lista as tarefas da fila. </p>
<p>Percorre os links dos ponteiros listando os elementos a serem processados pela ASM do MQTT-SN</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                              {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keyword">struct </span><a class="code" href="structnode.html">node</a> *temp;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordtype">char</span> *task_type;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  temp = mqtt_queue_first;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  debug_task(<span class="stringliteral">&quot;VALOR DO GLOBAL ID g_task_id:%d&quot;</span>,g_task_id);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  debug_task(<span class="stringliteral">&quot;FILA:&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="keywordflow">while</span> (temp) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <a class="code" href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a>(temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a>,&amp;task_type);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      debug_task(<span class="stringliteral">&quot;[%2.0d][%s][%d]&quot;</span>,(<span class="keywordtype">int</span>)temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">id_task</a>, task_type,temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">short_topic</a>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      temp = temp-&gt;link;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      cnt++;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  debug_task(<span class="stringliteral">&quot;Tamanho da fila:[%d]&quot;</span>, cnt);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;}</div>
<div class="ttc" id="structnode_html"><div class="ttname"><a href="structnode.html">node</a></div><div class="ttdoc">Estrutura de fila MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:390</div></div>
<div class="ttc" id="mqtt__sn_8c_html_ac598f98e844bfd5bbdb577099ddf06d1"><div class="ttname"><a href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a></div><div class="ttdeci">void parse_mqtt_type_string(uint8_t type, char **type_string)</div><div class="ttdoc">Retorna a string de status correspondente. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:121</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a1dba79ab8685a56d3ae57d84aca21ce8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">mqtt_sn_task_t::id_task</a></div><div class="ttdeci">uint16_t id_task</div><div class="ttdoc">Identificador da tarefa. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:378</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a25bc8ea535927589bca3720e0e838958"><div class="ttname"><a href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">mqtt_sn_task_t::short_topic</a></div><div class="ttdeci">uint8_t short_topic</div><div class="ttdoc">Tópico curto ou topic id a ser publicado/inscrito. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:377</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a172afa34fe10ad1ee4ffc0d226b35b4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_check_rc </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia requisição de conexão ao broker MQTT-SN. </p>
<p>Realiza o envio de mensagens do tipo CONNECT ao broker MQTT-SN</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rc</td><td>Código de retorno da requisição MQTT (Return Code)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha por algum motivo no código de retorno </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso no recebimento do código de retorno</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Tarefa:</a></b></dt><dd>Expandir o tipo de falha para tornar mais precisa a depuração futura </dd></dl>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                       {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">switch</span> (rc) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">case</span> ACCEPTED:</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">case</span> REJECTED_CONGESTION:</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">case</span> REJECTED_INVALID_TOPIC_ID:</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">case</span> REJECTED_NOT_SUPPORTED:</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a200e89a8fd400c652431bd505de6f827"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#aab2bca192b63f37bf4847be3686bca75">mqtt_sn_status_t</a> mqtt_sn_check_status </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checa o status da conexão MQTT-SN. </p>
<p>Retorna o status da conexão MQTT-SN baseado na estrutura mqtt_sn_status_t</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">mqtt_sn_status_t</td><td>Estado da conexão </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                           {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">return</span> mqtt_status;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9bd6d4e9304d00d28861751c22b146e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* mqtt_sn_check_status_string </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checa o status da conexãoe em String. </p>
<p>Verifica o status da conexão MQTT-SN e retorna uma string com o estado</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Não</td><td>recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STRING</td><td>String do estado atual da conexão MQTT-SN </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                       {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">switch</span> (mqtt_status) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">case</span> MQTTSN_DISCONNECTED:</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;DESCONECTADO&quot;</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_CONNACK:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;AGUARDANDO CONNACK&quot;</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_REGACK:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;AGUARDANDO REGACK&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">case</span> MQTTSN_CONNECTED:</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;#### CONECTADO ####&quot;</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">case</span> MQTTSN_TOPIC_REGISTERED:</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;TOPICOS REGISTRADOS&quot;</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_WILLTOPICREQ:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;AGUARDANDO WILL TOPIC&quot;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_WILLMSGREQ:</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;AGUARDANDO WILL MESSAGE&quot;</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;ESTADO NAO DESCRITO&quot;</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b8eb51076a2923f2c036f1ff925c168"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_con_send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia requisição de conexão ao broker MQTT-SN. </p>
<p>Realiza o envio de mensagens do tipo CONNECT ao broker MQTT-SN</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar o pacote CONNECT </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar o pacote CONNECT </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                 {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="structconnect__packet__t.html">connect_packet_t</a> packet;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// Criação do pacote CONNECT</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  packet.type = MQTT_SN_TYPE_CONNECT;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  packet.flags = MQTT_SN_FLAG_CLEAN;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (g_will)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    packet.flags += MQTT_SN_FLAG_WILL;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  packet.protocol_id = MQTT_SN_PROTOCOL_ID;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  packet.duration = uip_htons(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a276b967ec5d6e3305ee4695488e4472b">keep_alive</a>); <span class="comment">//Realiza a conversão para network byte order</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  strncpy(packet.client_id, g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>, strlen(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>));</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  packet.client_id[strlen(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>)] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  packet.length = 0x06 + strlen(packet.client_id);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// debug_mqtt(&quot;CLIENT_ID:%s, Tamanho:%d&quot;,packet.client_id,strlen(packet.client_id));</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @CONNECT &quot;</span>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// debug_mqtt(&quot;enviado!&quot;);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
<div class="ttc" id="structmqtt__sn__con__t_html_a3880622ca383fee22fbbac18442bae32"><div class="ttname"><a href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">mqtt_sn_con_t::client_id</a></div><div class="ttdeci">const char * client_id</div><div class="ttdoc">Identificador de cliente para conexão com o broker MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:455</div></div>
<div class="ttc" id="structconnect__packet__t_html"><div class="ttname"><a href="structconnect__packet__t.html">connect_packet_t</a></div><div class="ttdoc">Estrutura de pacotes MQTT-SN do tipo CONNECT. </div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="structmqtt__sn__con__t_html_a276b967ec5d6e3305ee4695488e4472b"><div class="ttname"><a href="structmqtt__sn__con__t.html#a276b967ec5d6e3305ee4695488e4472b">mqtt_sn_con_t::keep_alive</a></div><div class="ttdeci">uint8_t keep_alive</div><div class="ttdoc">Tempo de requisição Keep Alive para PINGREQ e PINGRESP. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:454</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8771e78d9d8d5379ff27fba1feefe37c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_create_sck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmqtt__sn__con__t.html">mqtt_sn_con_t</a>&#160;</td>
          <td class="paramname"><em>mqtt_sn_connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topics</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>topic_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mqtt__sn_8h.html#a679e4bebc7798d960960760150bdc5a7">mqtt_sn_cb_f</a>&#160;</td>
          <td class="paramname"><em>cb_f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicia conexão ao broker UDP. </p>
<p>Estabelece a conexão com um servidor MQTT-SN, através da porta 1884 além de iniciar a fila de processos de conexão do protocolo.</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mqtt_sn_connection</td><td>Estrutura padrão de comunicação MQTT-SN </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topics</td><td>Vetor de tópicos a serem registrados </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topic_len</td><td>Tamanho do vetor de tópicos a serem registrados </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mqtt_sn_cb_f</td><td>Ponteiro para função de callback para recebimento das mensagens MQTT-SN</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao alocar conexão UDP </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao alocar conexão UDP </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                                                                                                    {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  callback_mqtt = cb_f;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">/************************************ RECONEXÃO******************************/</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  topics_len = topic_len;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="keywordtype">size_t</span> t = 0;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">for</span> (t=0; t &lt; topic_len; t++){</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    topics_reconnect[t] = topics[t];</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">// debug_mqtt(&quot;Armazenando topico: %s&quot;,(char *)topics_reconnect[t]);</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">/************************************ RECONEXÃO******************************/</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keyword">static</span> uip_ipaddr_t broker_addr;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="keyword">static</span> uint8_t con_udp_status = 0;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  g_mqtt_sn_con = mqtt_sn_connection;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  uip_ip6addr(&amp;broker_addr, *g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>,</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                            *(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>+1),</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                            *(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>+2),</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                            *(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>+3),</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                            *(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>+4),</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                            *(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>+5),</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                            *(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>+6),</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                            *(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">ipv6_broker</a>+7));</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="keywordflow">if</span> (strlen(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>) &gt; 23){</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Cli. ID SIZE:%d &gt; 23!&quot;</span>,strlen(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>));</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Endereco do broker IPv6: &quot;</span>);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  uip_debug_ipaddr_print(&amp;broker_addr);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Endereco da porta:%d &quot;</span>,g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#ae3c6408a5f3fb41bcddcf7e8266f41a6">udp_port</a>);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Client ID:%s/%d&quot;</span>,g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>,strlen(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>));</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">if</span>(!g_recon){</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    con_udp_status = simple_udp_register(&amp;g_mqtt_sn_con.udp_con,</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                          g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#ae3c6408a5f3fb41bcddcf7e8266f41a6">udp_port</a>,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                                          &amp;broker_addr,</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                          g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#ae3c6408a5f3fb41bcddcf7e8266f41a6">udp_port</a>,</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                          <a class="code" href="mqtt__sn_8c.html#ab6fc2a07c15881877943348bef786cd8">mqtt_sn_udp_rec_cb</a>);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">if</span>(!con_udp_status)</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">if</span> (g_mqtt_sn_con.will_topic &amp;&amp; g_mqtt_sn_con.will_message)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    g_will = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">/****************************************************************************/</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">// Criando tarefa de [CONNECT]</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">// Inicialmente precisamos enviar a requisição de CONNECT ao broker MQTT-SN pa</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">// ra que seja possível qualquer outra operação.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <a class="code" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a> connect_task;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">// debug_mqtt(&quot;Criando tarefa de CONNECT&quot;);</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  connect_task.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> = MQTT_SN_TYPE_CONNECT;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <a class="code" href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a>(connect_task);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">/****************************************************************************/</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">/****************************************************************************/</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">// Implementação do recurso de [LWT]</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">// Verificando se o usuário quer utilizar will topic e will message</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">if</span> (g_mqtt_sn_con.will_topic &amp;&amp; g_mqtt_sn_con.will_message){</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a> will_topic_task;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    will_topic_task.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> = MQTT_SN_TYPE_WILLTOPIC;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a>(will_topic_task);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <a class="code" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a> will_message_task;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    will_message_task.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> = MQTT_SN_TYPE_WILLMSG;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <a class="code" href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a>(will_message_task);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">/****************************************************************************/</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// Criando tarefas de [REGISTER]</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// Para cada tópico definido pelo usuário no código principal.Inicia-se o pro</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="comment">// cesso de preenchimento de tarefas na fila de serviços MQT-SN.</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">// Primeiro antes de qualquer processo MQTT-SN registra-se todos os tópicos in</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// formados pelo usuário, otimizando as funções de inscrição e publicação, o</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">// broker irá então responder com os respectivos SHORT TOPIC para utilizarmos.</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <a class="code" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a> topic_reg;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="comment">// debug_mqtt(&quot;Criando tarefa de REGISTER&quot;);</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">for</span>(i = 0; i &lt; topic_len; i++){</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span> (g_mqtt_sn_con.will_topic &amp;&amp; g_mqtt_sn_con.will_message)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      g_topic_bind[g_task_id-2].topic_name = topics_reconnect[i]; <span class="comment">// Antecipa-se 2 no indíce em função das 2 tasks já alocadas para WILL do LWT</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      g_topic_bind[g_task_id].topic_name = topics_reconnect[i];</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    topic_reg.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> = MQTT_SN_TYPE_REGISTER;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a>(topic_reg)) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="comment">/****************************************************************************/</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  process_post(&amp;mqtt_sn_main, mqtt_event_run_task, NULL);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;}</div>
<div class="ttc" id="structmqtt__sn__con__t_html_a3880622ca383fee22fbbac18442bae32"><div class="ttname"><a href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">mqtt_sn_con_t::client_id</a></div><div class="ttdeci">const char * client_id</div><div class="ttdoc">Identificador de cliente para conexão com o broker MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:455</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html"><div class="ttname"><a href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a></div><div class="ttdoc">Estrutura de tarefa de fila MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:375</div></div>
<div class="ttc" id="mqtt__sn_8c_html_ab6fc2a07c15881877943348bef786cd8"><div class="ttname"><a href="mqtt__sn_8c.html#ab6fc2a07c15881877943348bef786cd8">mqtt_sn_udp_rec_cb</a></div><div class="ttdeci">void mqtt_sn_udp_rec_cb(struct simple_udp_connection *c, const uip_ipaddr_t *sender_addr, uint16_t sender_port, const uip_ipaddr_t *receiver_addr, uint16_t receiver_port, const uint8_t *data, uint16_t datalen)</div><div class="ttdoc">Callback de recepção UDP. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:865</div></div>
<div class="ttc" id="structmqtt__sn__con__t_html_ae3c6408a5f3fb41bcddcf7e8266f41a6"><div class="ttname"><a href="structmqtt__sn__con__t.html#ae3c6408a5f3fb41bcddcf7e8266f41a6">mqtt_sn_con_t::udp_port</a></div><div class="ttdeci">uint16_t udp_port</div><div class="ttdoc">Porta UDP de conexão com o broker (default:1884) </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:452</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a575514d0f0fd3b6c5c4a2c75e604bf79"><div class="ttname"><a href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a></div><div class="ttdeci">resp_con_t mqtt_sn_insert_queue(mqtt_sn_task_t new)</div><div class="ttdoc">Insere uma tarefa na fila. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:630</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="structmqtt__sn__con__t_html_a058796ada31936dced646e5da3eb329a"><div class="ttname"><a href="structmqtt__sn__con__t.html#a058796ada31936dced646e5da3eb329a">mqtt_sn_con_t::ipv6_broker</a></div><div class="ttdeci">uint16_t * ipv6_broker</div><div class="ttdoc">Endereço IPv6 do broker UDP. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:453</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa17781596362470e100d5fc4f62a01e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mqtt_sn_delete_queue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove o elemento mais próximo de ser processado. </p>
<p>Realiza a remoção do elemento mais próximo de ser processado, no caso o mais antigo inserido na fila</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Tarefa:</a></b></dt><dd>Adicionar opção de exclusão intermediária </dd></dl>
<div class="fragment"><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                               {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keyword">struct </span><a class="code" href="structnode.html">node</a> *temp;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordtype">char</span> *task_type;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  temp = mqtt_queue_first;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">if</span> (mqtt_queue_first-&gt;link == NULL) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      g_task_id = 0;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <a class="code" href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a>(mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a>,&amp;task_type);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      debug_task(<span class="stringliteral">&quot;Task removida:[%2.0d][%s]&quot;</span>,(<span class="keywordtype">int</span>)mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">id_task</a>,task_type);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      debug_task(<span class="stringliteral">&quot;Task info: Fila vazia&quot;</span>);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      mqtt_queue_first = mqtt_queue_last = NULL;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      g_task_id--;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <a class="code" href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a>(mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a>,&amp;task_type);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      debug_task(<span class="stringliteral">&quot;Task removida:[%2.0d][%s]&quot;</span>,(<span class="keywordtype">int</span>)mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">id_task</a>,task_type);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      mqtt_queue_first = mqtt_queue_first-&gt;link;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      free(temp);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div>
<div class="ttc" id="structnode_html"><div class="ttname"><a href="structnode.html">node</a></div><div class="ttdoc">Estrutura de fila MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:390</div></div>
<div class="ttc" id="mqtt__sn_8c_html_ac598f98e844bfd5bbdb577099ddf06d1"><div class="ttname"><a href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a></div><div class="ttdeci">void parse_mqtt_type_string(uint8_t type, char **type_string)</div><div class="ttdoc">Retorna a string de status correspondente. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:121</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a1dba79ab8685a56d3ae57d84aca21ce8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">mqtt_sn_task_t::id_task</a></div><div class="ttdeci">uint16_t id_task</div><div class="ttdoc">Identificador da tarefa. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:378</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adba0283cc8fadf24f2f04246c76e8cde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t mqtt_sn_get_qos_flag </td>
          <td>(</td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>qos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gera a flag de nível QoS. </p>
<p>Retorna o estado da flag correspondente ao nível QoS enviado</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qos</td><td>Nível QoS desejado</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">QoS</td><td>Retorna a flag do nível QoS desejado </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                        {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">switch</span> (qos) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">case</span> -1:</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="keywordflow">return</span> MQTT_SN_FLAG_QOS_N1;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="keywordflow">return</span> MQTT_SN_FLAG_QOS_0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordflow">return</span> MQTT_SN_FLAG_QOS_1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keywordflow">return</span> MQTT_SN_FLAG_QOS_2;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a46fe607d1db728d41ed6aec6fee3fc77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mqtt_sn_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicializa PROCESS_THREAD MQTT-SN. </p>
<p>Inicializa a PROCESS_THREAD de MQTT-SN bem como as variáveis utilizadas e a alocaçãod e eventos</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                       {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  process_start(&amp;mqtt_sn_main, NULL);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">// Alocação de número de evento disponível para os eventos do MQTT-SN</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  mqtt_event_connect         = process_alloc_event();</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  mqtt_event_connack         = process_alloc_event();</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  mqtt_event_register        = process_alloc_event();</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  mqtt_event_regack          = process_alloc_event();</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  mqtt_event_run_task        = process_alloc_event();</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  mqtt_event_pub_qos_0       = process_alloc_event();</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  mqtt_event_ping_timeout    = process_alloc_event();</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  mqtt_event_suback          = process_alloc_event();</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  mqtt_event_subscribe       = process_alloc_event();</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  mqtt_event_connected       = process_alloc_event();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  mqtt_event_will_topicreq   = process_alloc_event();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  mqtt_event_will_messagereq = process_alloc_event();</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <a class="code" href="mqtt__sn_8c.html#ada3c457ee81d0b29892742401845d918">init_vectors</a>();</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_ada3c457ee81d0b29892742401845d918"><div class="ttname"><a href="mqtt__sn_8c.html#ada3c457ee81d0b29892742401845d918">init_vectors</a></div><div class="ttdeci">void init_vectors(void)</div><div class="ttdoc">Inicializa os vetores MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:349</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a575514d0f0fd3b6c5c4a2c75e604bf79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_insert_queue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a>&#160;</td>
          <td class="paramname"><em>new</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insere uma tarefa na fila. </p>
<p>Insere uma nova tarefa na fila de requisições a serem processadas.</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">new</td><td>Nova tarefa a ser processada pela ASM do MQTT-SN</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Não foi possível alocar uma nova tarefa a fila </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Foi possível alocar uma nova tarefa a fila</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Tarefa:</a></b></dt><dd>Melhorar alocação dinâmica de memória </dd></dl>
<div class="fragment"><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                                                   {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keyword">struct </span><a class="code" href="structnode.html">node</a> *temp,*temp2;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  temp2 = mqtt_queue_first;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keywordflow">while</span> (temp2) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      temp2 = temp2-&gt;link;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      cnt++;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">//Limita o número máximo de tarefas alocadas na fila</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">if</span> (cnt &gt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga45ab5881e190d570f3784e50be2cce65">MAX_QUEUE_MQTT_SN</a>)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  temp = (<span class="keyword">struct </span><a class="code" href="structnode.html">node</a> *)malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structnode.html">node</a>));</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a>  = <span class="keyword">new</span>.msg_type_q;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">short_topic</a> = <span class="keyword">new</span>.short_topic;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  temp-&gt;data.retain      = <span class="keyword">new</span>.retain;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">qos_level</a>   = <span class="keyword">new</span>.qos_level;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">id_task</a>     = g_task_id;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  g_task_id++;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  temp-&gt;link = NULL;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="keywordflow">if</span> (mqtt_queue_last  ==  NULL) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      mqtt_queue_first = mqtt_queue_last = temp;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      mqtt_queue_last-&gt;link = temp;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      mqtt_queue_last = temp;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordtype">char</span> *task_type;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">//parse_mqtt_type_string(mqtt_queue_first-&gt;data.msg_type_q,&amp;task_type_2);</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">//debug_task(&quot;Task principal:[%2.0d][%s]&quot;,(int)mqtt_queue_first-&gt;data.id_task,task_type_2);</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <a class="code" href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a>(temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a>,&amp;task_type);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  debug_task(<span class="stringliteral">&quot;Task adicionada:[%2.0d][%s]&quot;</span>,(<span class="keywordtype">int</span>)temp-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">id_task</a>, task_type);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;}</div>
<div class="ttc" id="structnode_html"><div class="ttname"><a href="structnode.html">node</a></div><div class="ttdoc">Estrutura de fila MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:390</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga45ab5881e190d570f3784e50be2cce65"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga45ab5881e190d570f3784e50be2cce65">MAX_QUEUE_MQTT_SN</a></div><div class="ttdeci">#define MAX_QUEUE_MQTT_SN</div><div class="ttdoc">Número máximo de tarefas a serem inseridas alocadas dinamicamente MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:155</div></div>
<div class="ttc" id="mqtt__sn_8c_html_ac598f98e844bfd5bbdb577099ddf06d1"><div class="ttname"><a href="mqtt__sn_8c.html#ac598f98e844bfd5bbdb577099ddf06d1">parse_mqtt_type_string</a></div><div class="ttdeci">void parse_mqtt_type_string(uint8_t type, char **type_string)</div><div class="ttdoc">Retorna a string de status correspondente. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:121</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a1dba79ab8685a56d3ae57d84aca21ce8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">mqtt_sn_task_t::id_task</a></div><div class="ttdeci">uint16_t id_task</div><div class="ttdoc">Identificador da tarefa. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:378</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a5ce109928f26d01872230443c75c91f8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">mqtt_sn_task_t::qos_level</a></div><div class="ttdeci">uint8_t qos_level</div><div class="ttdoc">Nível QoS da tarefa a ser alocada na pilha. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:379</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a25bc8ea535927589bca3720e0e838958"><div class="ttname"><a href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">mqtt_sn_task_t::short_topic</a></div><div class="ttdeci">uint8_t short_topic</div><div class="ttdoc">Tópico curto ou topic id a ser publicado/inscrito. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:377</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af09083ea59a182fdf109b6e3fa213bec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mqtt_sn_ping_send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia requisição de ping ao broker. </p>
<p>Envia requisição de ping ao broker diretamente por mensagens PING REQ</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                            {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <a class="code" href="structping__req__t.html">ping_req_t</a> ping_request;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  ping_request.msg_type = MQTT_SN_TYPE_PINGREQ;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  strncpy(ping_request.client_id, g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>, strlen(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>));</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  ping_request.client_id[strlen(g_mqtt_sn_con.<a class="code" href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">client_id</a>)] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">//debug_mqtt(&quot;Client ID PING:%s&quot;,ping_request.client_id);</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  ping_request.length = 0x02 + strlen(ping_request.client_id);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">//debug_mqtt(&quot;Enviando @PINGREQ&quot;);</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;ping_request, ping_request.length);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
<div class="ttc" id="structmqtt__sn__con__t_html_a3880622ca383fee22fbbac18442bae32"><div class="ttname"><a href="structmqtt__sn__con__t.html#a3880622ca383fee22fbbac18442bae32">mqtt_sn_con_t::client_id</a></div><div class="ttdeci">const char * client_id</div><div class="ttdoc">Identificador de cliente para conexão com o broker MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:455</div></div>
<div class="ttc" id="structping__req__t_html"><div class="ttname"><a href="structping__req__t.html">ping_req_t</a></div><div class="ttdoc">Estrutura de pacote de desconexão do broker MQTT-SN. </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab8c0f238b41b373afb8b21e0f594b79d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_pub </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>retain_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>qos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepara requisição de publicação ao broker MQTT-SN. </p>
<p>Formata e gera a tarefa na fila para publicação no tópico pré-registrado</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser publicado </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Mensagem a ser publicada </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">retain_flag</td><td>Identificador de mensagem retentiva </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qos</td><td>Nível de QoS da publicação</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao gerar a tarefa de publicação </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao gerar a tarefa de publicação </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                                                                {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// Caso haja tópicos para registrar, não habilita a publicação</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// evitando que prejudique alguma transação, ou seja, tasks</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// tem prioridade sobre publicações diretas</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mqtt__sn_8c.html#a2620f37584b501fde35e71806a78b35a">unlock_tasks</a>())</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// Analisamos o buffer de tópicos registrados para ver se já foi registrado o tópico</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mqtt__sn_8c.html#ac81a0d1e0daa51cdb8495a52e317e140">verf_register</a>(topic))</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="mqtt__sn_8c.html#a550856b818c23fce9e4d5b253c3e7547">mqtt_sn_pub_send</a>(topic,message,retain_flag,qos);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a2620f37584b501fde35e71806a78b35a"><div class="ttname"><a href="mqtt__sn_8c.html#a2620f37584b501fde35e71806a78b35a">unlock_tasks</a></div><div class="ttdeci">bool unlock_tasks(void)</div><div class="ttdoc">Libera opção de geração de tarefas. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:110</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="mqtt__sn_8c_html_ac81a0d1e0daa51cdb8495a52e317e140"><div class="ttname"><a href="mqtt__sn_8c.html#ac81a0d1e0daa51cdb8495a52e317e140">verf_register</a></div><div class="ttdeci">resp_con_t verf_register(char *topic)</div><div class="ttdoc">Verifica pré-registro do tópico. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:331</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a550856b818c23fce9e4d5b253c3e7547"><div class="ttname"><a href="mqtt__sn_8c.html#a550856b818c23fce9e4d5b253c3e7547">mqtt_sn_pub_send</a></div><div class="ttdeci">resp_con_t mqtt_sn_pub_send(char *topic, char *message, bool retain_flag, uint8_t qos)</div><div class="ttdoc">Envia pacote PUBLISH ao broker MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:501</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a550856b818c23fce9e4d5b253c3e7547"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_pub_send </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>retain_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>qos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia pacote PUBLISH ao broker MQTT-SN. </p>
<p>Monta o pacote e envia ao broker a mensagem de publicação</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser publicado </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message</td><td>Mensagem a ser publicada </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qos</td><td>Nível de QoS da publicação</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar a publicação </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar a publicação </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                                                                     {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <a class="code" href="structpublish__packet__t.html">publish_packet_t</a> packet;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  uint16_t stopic = 0x0000;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  uint8_t data_len = strlen(message);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// if (mqtt_queue_first-&gt;data.msg_type_q != MQTT_SN_TYPE_PUBLISH) {</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">//   debug_mqtt(&quot;Erro: Pacote a processar nao e do tipo PUBLISH&quot;);</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">//   return FAIL_CON;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">if</span> (strcmp(g_topic_bind[i].topic_name,topic) == 0) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      stopic = g_topic_bind[i].short_topic_id;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">if</span> (data_len &gt; <span class="keyword">sizeof</span>(packet.data)) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      printf(<span class="stringliteral">&quot;Erro: Payload e muito grande!\n&quot;</span>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  packet.type  = MQTT_SN_TYPE_PUBLISH;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  packet.flags = 0x00;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">if</span> (retain_flag)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    packet.flags += MQTT_SN_FLAG_RETAIN;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  packet.flags += <a class="code" href="mqtt__sn_8c.html#adba0283cc8fadf24f2f04246c76e8cde">mqtt_sn_get_qos_flag</a>(qos);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// Segundo a especificação:</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// TopicIdType: indicates whether the field TopicId or TopicName included in this message contains a normal</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// topic id (set to “0b00”), a pre-defined topic id (set to “0b01”), or a short topic name (set to “0b10”). The</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// value “0b11” is reserved. Refer to sections 3 and 6.7 for the definition of the various types of topic ids.</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  packet.flags += MQTT_SN_TOPIC_TYPE_NORMAL; <span class="comment">//Utiliza-se o topic id já registrado</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  packet.topic_id = uip_htons(stopic);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  packet.message_id = uip_htons(0x00); <span class="comment">//Relevante somente se QoS &gt; 0</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  strncpy(packet.data, message, data_len+1);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">//  Pacote PUBLISH</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">//  _________________ ______________________ ___________ ________________ ______________ ________________</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// | Comprimento - 0 | Tipo de mensagem - 1 | Flags - 2 | Topic ID - 3,4 | Msg ID - 5,6 | Dado - 7,n ....|</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// |_________________|______________________|___________ ________________|______________|________________|</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  packet.length = 0x07 + (data_len+1);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @PUBLISH&quot;</span>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// debug_mqtt(&quot;Enviando o pacote @PUBLISH - Task:[%d]&quot;,(int)mqtt_queue_first-&gt;data.id_task);</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_adba0283cc8fadf24f2f04246c76e8cde"><div class="ttname"><a href="mqtt__sn_8c.html#adba0283cc8fadf24f2f04246c76e8cde">mqtt_sn_get_qos_flag</a></div><div class="ttdeci">uint8_t mqtt_sn_get_qos_flag(int8_t qos)</div><div class="ttdoc">Gera a flag de nível QoS. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:212</div></div>
<div class="ttc" id="structpublish__packet__t_html"><div class="ttname"><a href="structpublish__packet__t.html">publish_packet_t</a></div><div class="ttdoc">Estrutura de pacote de publicação MQTT-SN. </div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af9146fa082fe2bc6612fb13dbb20ed36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mqtt_sn_recv_parser </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Realiza o parsing das mensagens UDP recebidas. </p>
<p>Realiza o parsing das mensagens UDP recebidas de acordo com o protocolo MQTT-SN, alterando o status da conexão geral com o broker.</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Ponteiro para o conteúdo UDP recebido</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Tarefa:</a></b></dt><dd>Rever o short topic para adequar bytes [2][3] juntos.. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Tarefa:</a></b></dt><dd>Rever o short topic para adequar bytes [2][3] juntos... </dd></dl>
<div class="fragment"><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                             {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    uint8_t msg_type = data[1],</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            return_code = 0xFF,</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            short_topic;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// Como o MsgType não se altera de posição, testamos primeiro ele antes do</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="comment">// returning code, já que este pode variar</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">switch</span> (msg_type) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_CONNACK:</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        return_code = data[2]; <span class="comment">//No caso do CONNACK - RC[2]</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="mqtt__sn_8c.html#a172afa34fe10ad1ee4ffc0d226b35b4d">mqtt_sn_check_rc</a>(return_code)){</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <span class="keywordflow">if</span> (mqtt_status == MQTTSN_WAITING_CONNACK)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            process_post(&amp;mqtt_sn_main, mqtt_event_connack, NULL);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            debug_mqtt(<span class="stringliteral">&quot;Recebido CONNAC sem requisicao!&quot;</span>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_REGACK:</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        return_code = data[6]; <span class="comment">//No caso do REGACK - RC[6]</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        short_topic = data[3];</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="comment">// Na verdade os bytes de short topic são o [2] e [3], porém</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="comment">// só estamos usa-se o [3] porque não consideramos mais do que</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="comment">// 15 tópicos</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment"></span>        <span class="keywordflow">if</span> (<a class="code" href="mqtt__sn_8c.html#a172afa34fe10ad1ee4ffc0d226b35b4d">mqtt_sn_check_rc</a>(return_code)){</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;          <span class="keywordflow">for</span> (i = 0;i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++) { <span class="comment">//Compara o byte menor do MSG ID para atribuir o short topic a requisição REGISTER correta</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="keywordflow">if</span> (i == data[5]){</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;              g_topic_bind[i].short_topic_id = short_topic;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          <span class="keywordflow">if</span> (mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> == MQTT_SN_TYPE_REGISTER &amp;&amp;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;              mqtt_status == MQTTSN_WAITING_REGACK)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            process_post(&amp;mqtt_sn_main, mqtt_event_regack, NULL);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            debug_mqtt(<span class="stringliteral">&quot;Recebido REGACK sem requisicao!&quot;</span>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_PUBACK:</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="comment">// return_code = data[6]; //No caso do PUBACK - RC[6]</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="comment">// short_topic = data[3];</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="comment">// // Na verdade os bytes de short topic são o [2] e [3], porém</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="comment">// // só estamos usa-se o [3] porque não consideramos mais do que</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="comment">// // 15 tópicos</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="comment">// /// @todo Rever o short topic para adequar bytes [2][3] juntos</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="comment">// /// @TODO Implementar verificação de message ID e short topic ID para melhorar a confiança do recebimento</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="comment">// if (mqtt_sn_check_rc(return_code))</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="comment">//   if (mqtt_queue_first-&gt;data.msg_type_q == MQTT_SN_TYPE_PUBLISH)</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="comment">//     process_post(&amp;mqtt_sn_main, mqtt_event_puback, NULL);</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_SUBACK:</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        return_code = data[7]; <span class="comment">//No caso do SUBACK - RC[7]</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        short_topic = data[4];</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="comment">// Na verdade os bytes de short topic são o [2] e [3], porém</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">// só estamos usa-se o [3] porque não consideramos mais do que</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">// 15 tópicos</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"></span>        debug_mqtt(<span class="stringliteral">&quot;Recebido SUBACK&quot;</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="mqtt__sn_8c.html#a172afa34fe10ad1ee4ffc0d226b35b4d">mqtt_sn_check_rc</a>(return_code))</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;          <span class="keywordflow">if</span> (short_topic != 0x00) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            debug_mqtt(<span class="stringliteral">&quot;Reconhecimento de inscricao:[%s]&quot;</span>,g_topic_bind[short_topic].topic_name);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            g_topic_bind[short_topic].subscribed = 0x02;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">if</span> (mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> == MQTT_SN_TYPE_SUBSCRIBE &amp;&amp;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                mqtt_status == MQTTSN_WAITING_SUBACK)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;              process_post(&amp;mqtt_sn_main, mqtt_event_suback, NULL);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;              debug_mqtt(<span class="stringliteral">&quot;Recebido SUBACK sem requisicao!&quot;</span>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            debug_mqtt(<span class="stringliteral">&quot;Recebido SUBACK de WILDCARD&quot;</span>);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <span class="keywordflow">if</span> (mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> == MQTT_SN_TYPE_SUB_WILDCARD){</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;              mqtt_status = MQTTSN_TOPIC_REGISTERED;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;              <a class="code" href="mqtt__sn_8c.html#aa17781596362470e100d5fc4f62a01e9">mqtt_sn_delete_queue</a>();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          debug_mqtt(<span class="stringliteral">&quot;Erro: Codigo de retorno invalido&quot;</span>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_PINGRESP:</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        g_ping_flag_resp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="comment">//debug_mqtt(&quot;Ping respondido&quot;);</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_PINGREQ:</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <a class="code" href="mqtt__sn_8c.html#af09083ea59a182fdf109b6e3fa213bec">mqtt_sn_ping_send</a>();</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_PUBLISH:</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Recebida publicacao:&quot;</span>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        uint8_t message_length = data[0]-7;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">//uint8_t msg_id = data[6];</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        short_topic = data[4];</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordtype">char</span> message[MQTT_SN_MAX_PACKET_LENGTH];</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">// debug_mqtt(&quot;[Msg_ID][%d]/[Topic ID][%d]&quot;,msg_id,short_topic);</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; (message_length); i++)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          message[i] = data[i+7];</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        message[i] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="comment">// debug_mqtt(&quot;Topico:%s&quot;,g_topic_bind[short_topic].topic_name);</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="comment">// debug_mqtt(&quot;Mensagem:%s&quot;,message);</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="comment">// debug_mqtt(&quot;\n&quot;);</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        (*callback_mqtt)(g_topic_bind[short_topic].topic_name, message);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_REGISTER:</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Recebido registro de topico novo:&quot;</span>);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        uint8_t msg_id_reg = data[5];</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        uint8_t message_length_buf = data[0]-6;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordtype">size_t</span> j,t;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordtype">char</span> buff[MQTT_SN_MAX_TOPIC_LENGTH];</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        short_topic = data[3];</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">for</span> (t = 0; t &lt; message_length_buf; t++)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          buff[t] = data[t+6];</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        buff[t] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; j++)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          <span class="keywordflow">if</span> (g_topic_bind[j].short_topic_id == 0xFF)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="comment">// Apesar de a variável ser local (buff) precisamos alocar dinamicamente</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="comment">// memória para o ponteiro s para que consigamos fornecer um novo endereço</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">// de memória para a estrutura g_topic_bind...</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordtype">char</span> *s;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        s = (<span class="keywordtype">char</span> *)malloc(strlen(buff)+1);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        strcpy(s,buff);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        g_topic_bind[j].short_topic_id = short_topic;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        g_topic_bind[j].subscribed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        g_topic_bind[j].topic_name = s;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Topico registrado![%s]&quot;</span>,g_topic_bind[j].topic_name);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <a class="code" href="mqtt__sn_8c.html#aa6e0e9b8d7769407ab35fec5443e3896">mqtt_sn_regack_send</a>((uint16_t)msg_id_reg,(uint16_t)short_topic);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_WILLTOPICREQ:</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="comment">// debug_mqtt(&quot;Recebido um pacote WILL TOPIC REQ&quot;);</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">if</span> (mqtt_status == MQTTSN_WAITING_WILLTOPICREQ)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;          process_post(&amp;mqtt_sn_main,mqtt_event_will_topicreq,NULL);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">case</span> MQTT_SN_TYPE_WILLMSGREQ:</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">if</span> (mqtt_status == MQTTSN_WAITING_WILLMSGREQ)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          process_post(&amp;mqtt_sn_main,mqtt_event_will_messagereq,NULL);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Recebida mensagem porem nao identificada!&quot;</span>);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_aa6e0e9b8d7769407ab35fec5443e3896"><div class="ttname"><a href="mqtt__sn_8c.html#aa6e0e9b8d7769407ab35fec5443e3896">mqtt_sn_regack_send</a></div><div class="ttdeci">resp_con_t mqtt_sn_regack_send(uint16_t msg_id, uint16_t topic_id)</div><div class="ttdoc">Envia pacote do tipo REGACK ao broker. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:487</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
<div class="ttc" id="mqtt__sn_8c_html_aa17781596362470e100d5fc4f62a01e9"><div class="ttname"><a href="mqtt__sn_8c.html#aa17781596362470e100d5fc4f62a01e9">mqtt_sn_delete_queue</a></div><div class="ttdeci">void mqtt_sn_delete_queue(void)</div><div class="ttdoc">Remove o elemento mais próximo de ser processado. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:669</div></div>
<div class="ttc" id="mqtt__sn_8c_html_af09083ea59a182fdf109b6e3fa213bec"><div class="ttname"><a href="mqtt__sn_8c.html#af09083ea59a182fdf109b6e3fa213bec">mqtt_sn_ping_send</a></div><div class="ttdeci">void mqtt_sn_ping_send(void)</div><div class="ttdoc">Envia requisição de ping ao broker. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:410</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a172afa34fe10ad1ee4ffc0d226b35b4d"><div class="ttname"><a href="mqtt__sn_8c.html#a172afa34fe10ad1ee4ffc0d226b35b4d">mqtt_sn_check_rc</a></div><div class="ttdeci">resp_con_t mqtt_sn_check_rc(uint8_t rc)</div><div class="ttdoc">Envia requisição de conexão ao broker MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:192</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae17664af7f894e29743fafdf8bf98f89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_reg_send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envio de mensagens ao broker do tipo REGISTER. </p>
<p>Envia ao broker mensagens do tipo REGISTER com o topic name informado conforme a tarefa primeira na fila</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe parâmetro</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar o pacote REGISTER </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar o pacote REGISTER </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                                 {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="structregister__packet__t.html">register_packet_t</a> packet;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">for</span> (i=1; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> (g_topic_bind[i].short_topic_id == 0xFF)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  uint16_t task_id = i;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// Leak of memory</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">//size_t topic_name_len = strlen(mqtt_queue_first-&gt;data.long_topic); //Pega o primeiro da fila aguardando</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordtype">size_t</span> topic_name_len = strlen(g_topic_bind[task_id].topic_name);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordflow">if</span> (topic_name_len &gt; MQTT_SN_MAX_TOPIC_LENGTH) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Erro: Nome do topico excede o limite maximo&quot;</span>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordflow">if</span> (mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a> != MQTT_SN_TYPE_REGISTER) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Erro: Pacote a processar nao e do tipo REGISTER&quot;</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  packet.type = MQTT_SN_TYPE_REGISTER;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  packet.topic_id = 0x0000;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Quando o broker responder com o short topic ID,</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// ele utilizará como message id, o identificador único da task na</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// queue de serviços do MQTT-SN, logo se torna fácil saber como montar</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// a relação (short_topic/long_topic) no vetor global g_topic_bind[]</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  packet.message_id = uip_htons(task_id);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  strncpy(packet.topic_name, g_topic_bind[task_id].topic_name, topic_name_len);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  packet.length = 0x06 + topic_name_len;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  packet.topic_name[topic_name_len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Topico a registrar:%s [%d][MSG_ID:%d]&quot;</span>,packet.topic_name,strlen(packet.topic_name),(<span class="keywordtype">int</span>)mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">id_task</a>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @REGISTER&quot;</span>);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="ttc" id="structmqtt__sn__task__t_html_a1dba79ab8685a56d3ae57d84aca21ce8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a1dba79ab8685a56d3ae57d84aca21ce8">mqtt_sn_task_t::id_task</a></div><div class="ttdeci">uint16_t id_task</div><div class="ttdoc">Identificador da tarefa. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:378</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
<div class="ttc" id="structregister__packet__t_html"><div class="ttname"><a href="structregister__packet__t.html">register_packet_t</a></div><div class="ttdoc">Estrutura de pacotes MQTT-SN do tipo REGISTER. </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa6e0e9b8d7769407ab35fec5443e3896"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_regack_send </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>msg_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>topic_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia pacote do tipo REGACK ao broker. </p>
<p>Envia ao broker MQTT-SN a mensagem do tipo REGACK quando receber algum tópico via Wildcad</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg_id</td><td>Message id correspondente do envio </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">topic_id</td><td>Topic ID enviado pelo broker para registrar no vetor de tópicos o tópico novo</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar a regack </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar a regack </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                                                  {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <a class="code" href="structregack__packet__t.html">regack_packet_t</a> packet;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  packet.type = MQTT_SN_TYPE_REGACK;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  packet.topic_id = uip_htons(topic_id);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  packet.message_id = uip_htons(msg_id);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  packet.return_code = 0x00;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  packet.length = 0x07;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @REGACK&quot;</span>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="structregack__packet__t_html"><div class="ttname"><a href="structregack__packet__t.html">regack_packet_t</a></div><div class="ttdoc">Estrutura de pacotes MQTT-SN do tipo REGACK. </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aab8d5db0224c9b083af9f18094053795"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_sub </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>qos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepara requisição de inscrição ao broker MQTT-SN. </p>
<p>Formata e gera a tarefa na fila para inscrição no tópico pré-registrado</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser inscrito </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qos</td><td>Nível de QoS da inscrição</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao gerar a tarefa de inscrição </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao gerar a tarefa de inscrição </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                                {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// Caso haja tópicos para registrar, não habilita a inscrição</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// evitando que prejudique alguma transação, ou seja, tasks</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">// tem prioridade sobre inscrições diretas</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// if (!unlock_tasks())</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// return FAIL_CON;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span>(strstr(topic,<span class="stringliteral">&quot;#&quot;</span>) || strstr(topic,<span class="stringliteral">&quot;+&quot;</span>)){</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="mqtt__sn_8c.html#ac5fde757ae886c8827b853125f7458bd">mqtt_sn_sub_wildcard</a>(topic,qos);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mqtt__sn_8c.html#ac81a0d1e0daa51cdb8495a52e317e140">verf_register</a>(topic))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="mqtt__sn_8c.html#af60c0aa848adffbfe41a2e655a279f9d">verf_hist_sub</a>(topic)){</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a> subscribe_task;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">if</span>(strcmp(g_topic_bind[i].topic_name,topic) == 0) <span class="comment">// Tópico novo ou existe?</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    subscribe_task.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a>      = MQTT_SN_TYPE_SUBSCRIBE;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    subscribe_task.<a class="code" href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">qos_level</a>       = qos;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    subscribe_task.<a class="code" href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">short_topic</a>     = i;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// Comentadas as duas linhas abaixo porque consideraremos que o usuário irá registrar os</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// topicos no começo do programa não sendo necessário gerar o evento de run_task</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">//if (mqtt_sn_check_empty())</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">//  ctimer_set(&amp;mqtt_time_subscribe, 3*MQTT_SN_TIMEOUT, init_sub, NULL);</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a>(subscribe_task))</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     debug_task(<span class="stringliteral">&quot;ERRO AO ADICIONAR NA FILA&quot;</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_ac5fde757ae886c8827b853125f7458bd"><div class="ttname"><a href="mqtt__sn_8c.html#ac5fde757ae886c8827b853125f7458bd">mqtt_sn_sub_wildcard</a></div><div class="ttdeci">resp_con_t mqtt_sn_sub_wildcard(char *topic, uint8_t qos)</div><div class="ttdoc">Prepara tarefa de SUBSCRIBE do tipo WILDCARD. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:227</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html"><div class="ttname"><a href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a></div><div class="ttdoc">Estrutura de tarefa de fila MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:375</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a575514d0f0fd3b6c5c4a2c75e604bf79"><div class="ttname"><a href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a></div><div class="ttdeci">resp_con_t mqtt_sn_insert_queue(mqtt_sn_task_t new)</div><div class="ttdoc">Insere uma tarefa na fila. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:630</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="mqtt__sn_8c_html_af60c0aa848adffbfe41a2e655a279f9d"><div class="ttname"><a href="mqtt__sn_8c.html#af60c0aa848adffbfe41a2e655a279f9d">verf_hist_sub</a></div><div class="ttdeci">resp_con_t verf_hist_sub(char *topic)</div><div class="ttdoc">Verifica se o tópico já foi registrado. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:295</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a5ce109928f26d01872230443c75c91f8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">mqtt_sn_task_t::qos_level</a></div><div class="ttdeci">uint8_t qos_level</div><div class="ttdoc">Nível QoS da tarefa a ser alocada na pilha. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:379</div></div>
<div class="ttc" id="mqtt__sn_8c_html_ac81a0d1e0daa51cdb8495a52e317e140"><div class="ttname"><a href="mqtt__sn_8c.html#ac81a0d1e0daa51cdb8495a52e317e140">verf_register</a></div><div class="ttdeci">resp_con_t verf_register(char *topic)</div><div class="ttdoc">Verifica pré-registro do tópico. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:331</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a25bc8ea535927589bca3720e0e838958"><div class="ttname"><a href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">mqtt_sn_task_t::short_topic</a></div><div class="ttdeci">uint8_t short_topic</div><div class="ttdoc">Tópico curto ou topic id a ser publicado/inscrito. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:377</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a105b8d440266b4a582f2d627e57be14a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_sub_send </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>qos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia pacote SUBSCRIBE ao broker MQTT-SN. </p>
<p>Monta o pacote e envia ao broker a mensagem de inscrição</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser inscrito (deve estar pré-listado e passado como argumento em mqtt_sn_create_sck) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qos</td><td>Nível de QoS da publicação</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar a inscrição </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar a inscrição </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                                     {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="structsubscribe__packet__t.html">subscribe_packet_t</a> packet;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  uint16_t stopic = 0x0000;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// if (mqtt_queue_first-&gt;data.msg_type_q != MQTT_SN_TYPE_PUBLISH) {</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">//   debug_mqtt(&quot;Erro: Pacote a processar nao e do tipo PUBLISH&quot;);</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="comment">//   return FAIL_CON;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">if</span> (strcmp(g_topic_bind[i].topic_name,topic) == 0) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      stopic = g_topic_bind[i].short_topic_id;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  packet.type  = MQTT_SN_TYPE_SUBSCRIBE;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  packet.flags = 0x00;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  packet.flags += <a class="code" href="mqtt__sn_8c.html#adba0283cc8fadf24f2f04246c76e8cde">mqtt_sn_get_qos_flag</a>(0);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  packet.message_id = uip_htons(stopic);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  packet.topic_id =  uip_htons(stopic);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  packet.flags += MQTT_SN_TOPIC_TYPE_PREDEFINED; <span class="comment">//Utiliza-se o topic id já registrado</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  packet.length = 0x07;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">//  Pacote SUBSCRIBE</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">//  _________________ ______________________ ___________ ________________ _____________________________________</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="comment">// | Comprimento - 0 | Tipo de mensagem - 1 | Flags - 2 | Msg ID - 3,4  | Topic ID - 5,6 ou Topic name 5,n ....|</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// |_________________|______________________|___________|_______________|______________________________________|</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @SUBSCRIBE&quot;</span>);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_adba0283cc8fadf24f2f04246c76e8cde"><div class="ttname"><a href="mqtt__sn_8c.html#adba0283cc8fadf24f2f04246c76e8cde">mqtt_sn_get_qos_flag</a></div><div class="ttdeci">uint8_t mqtt_sn_get_qos_flag(int8_t qos)</div><div class="ttdoc">Gera a flag de nível QoS. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:212</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
<div class="ttc" id="structsubscribe__packet__t_html"><div class="ttname"><a href="structsubscribe__packet__t.html">subscribe_packet_t</a></div><div class="ttdoc">Estrutura de pacote MQTT-SN do tipo SUBSCRIBE. </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a831d03a2cd7fbc884cec2013c2ebc823"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_sub_send_wildcard </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>qos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia pacote SUBSCRIBE do tipo WILDCARD ao broker MQTT-SN. </p>
<p>Monta o pacote e envia ao broker a mensagem de inscrição do tipo Wildcard (#,+)</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser inscrito (deve estar pré-listado e passado como argumento em mqtt_sn_create_sck) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qos</td><td>Nível de QoS da publicação</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar a inscrição </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar a inscrição </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                                                              {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="code" href="structsubscribe__wildcard__packet__t.html">subscribe_wildcard_packet_t</a> packet;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// Analisamos o buffer de tópicos registrados para ver se já foi registrado o tópico</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++){</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span> (g_topic_bind[i].short_topic_id == 0xFF)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  packet.type  = MQTT_SN_TYPE_SUBSCRIBE;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  packet.flags = 0x00;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  packet.flags += <a class="code" href="mqtt__sn_8c.html#adba0283cc8fadf24f2f04246c76e8cde">mqtt_sn_get_qos_flag</a>(0);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  packet.message_id = uip_htons(i);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  strncpy(packet.topic_name,topic,strlen(topic));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  packet.flags += MQTT_SN_TOPIC_TYPE_NORMAL;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  packet.length = 0x05+strlen(topic);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="comment">//  Pacote SUBSCRIBE</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="comment">//  _________________ ______________________ ___________ ________________ _____________________________________</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// | Comprimento - 0 | Tipo de mensagem - 1 | Flags - 2 | Msg ID - 3,4  | Topic ID - 5,6 ou Topic name 5,n ....|</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// |_________________|______________________|___________|_______________|______________________________________|</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @SUBSCRIBE(Wildcard)&quot;</span>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div>
<div class="ttc" id="structsubscribe__wildcard__packet__t_html"><div class="ttname"><a href="structsubscribe__wildcard__packet__t.html">subscribe_wildcard_packet_t</a></div><div class="ttdoc">Estrutura de pacote de inscrição do tipo Wildcard MQTT-SN. </div></div>
<div class="ttc" id="mqtt__sn_8c_html_adba0283cc8fadf24f2f04246c76e8cde"><div class="ttname"><a href="mqtt__sn_8c.html#adba0283cc8fadf24f2f04246c76e8cde">mqtt_sn_get_qos_flag</a></div><div class="ttdeci">uint8_t mqtt_sn_get_qos_flag(int8_t qos)</div><div class="ttdoc">Gera a flag de nível QoS. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:212</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac5fde757ae886c8827b853125f7458bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_sub_wildcard </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>qos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepara tarefa de SUBSCRIBE do tipo WILDCARD. </p>
<p>Gera tarefa de inscrição com Wildcard ao broker MQTT-SN</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser inscrito (deve estar pré-listado e passado como argumento em mqtt_sn_create_sck) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qos</td><td>Nível de QoS da publicação</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar a inscrição </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar a inscrição </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                                         {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a> subscribe_task;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  subscribe_task.<a class="code" href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">msg_type_q</a>      = MQTT_SN_TYPE_SUB_WILDCARD;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  subscribe_task.<a class="code" href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">qos_level</a>       = qos;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  topic_temp_wildcard            = topic;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a>(subscribe_task))</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   debug_task(<span class="stringliteral">&quot;ERRO AO ADICIONAR NA FILA&quot;</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="ttc" id="structmqtt__sn__task__t_html"><div class="ttname"><a href="structmqtt__sn__task__t.html">mqtt_sn_task_t</a></div><div class="ttdoc">Estrutura de tarefa de fila MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:375</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_afb14d280d486f10af744fb1ac7f145eb"><div class="ttname"><a href="structmqtt__sn__task__t.html#afb14d280d486f10af744fb1ac7f145eb">mqtt_sn_task_t::msg_type_q</a></div><div class="ttdeci">uint8_t msg_type_q</div><div class="ttdoc">Tipo de mensagem a ser alocada. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:376</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a575514d0f0fd3b6c5c4a2c75e604bf79"><div class="ttname"><a href="mqtt__sn_8c.html#a575514d0f0fd3b6c5c4a2c75e604bf79">mqtt_sn_insert_queue</a></div><div class="ttdeci">resp_con_t mqtt_sn_insert_queue(mqtt_sn_task_t new)</div><div class="ttdoc">Insere uma tarefa na fila. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:630</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a5ce109928f26d01872230443c75c91f8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">mqtt_sn_task_t::qos_level</a></div><div class="ttdeci">uint8_t qos_level</div><div class="ttdoc">Nível QoS da tarefa a ser alocada na pilha. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:379</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab6fc2a07c15881877943348bef786cd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mqtt_sn_udp_rec_cb </td>
          <td>(</td>
          <td class="paramtype">struct simple_udp_connection *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uip_ipaddr_t *&#160;</td>
          <td class="paramname"><em>sender_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>sender_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uip_ipaddr_t *&#160;</td>
          <td class="paramname"><em>receiver_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>receiver_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback de recepção UDP. </p>
<p>Recebe dados da conexão UDP com o broker</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">simple_udp_connection</td><td>Handle da conexão UDP </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sender_addr</td><td>Endereço IP do broker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sender_port</td><td>Porta de envio </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">receiver_addr</td><td>Endereço IP de recepção </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">receiver_port</td><td>Porta de recepção </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>Dado recebido </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">datalen</td><td>Tamanho do dado recebido</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna parâmetro </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                              {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  debug_udp(<span class="stringliteral">&quot;##########RECEBIDO ALGO VIA UDP!##########&quot;</span>);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <a class="code" href="mqtt__sn_8c.html#af9146fa082fe2bc6612fb13dbb20ed36">mqtt_sn_recv_parser</a>(data);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_af9146fa082fe2bc6612fb13dbb20ed36"><div class="ttname"><a href="mqtt__sn_8c.html#af9146fa082fe2bc6612fb13dbb20ed36">mqtt_sn_recv_parser</a></div><div class="ttdeci">void mqtt_sn_recv_parser(const uint8_t *data)</div><div class="ttdoc">Realiza o parsing das mensagens UDP recebidas. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:717</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6718f310e6635c018a7126c5b1311e50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_will_message_send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia mensagem de LWT. </p>
<p>Envia mensagem a ser publicada quando o tópico se desconectar</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar a mensagem Will MSG </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar a mensagem Will MSG </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                                          {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <a class="code" href="structwillmessage__packet__t.html">willmessage_packet_t</a> packet;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordtype">size_t</span> message_name_len = strlen(g_mqtt_sn_con.will_message);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> (message_name_len &gt; MQTT_SN_MAX_TOPIC_LENGTH) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Erro: Nome da mensagem WILL excede o limite maximo&quot;</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  packet.type = MQTT_SN_TYPE_WILLMSG;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  strncpy(packet.will_message, g_mqtt_sn_con.will_message, message_name_len);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  packet.length = 0x02 + message_name_len;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  packet.will_message[message_name_len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @WILL MESSAGE&quot;</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="structwillmessage__packet__t_html"><div class="ttname"><a href="structwillmessage__packet__t.html">willmessage_packet_t</a></div><div class="ttdoc">Estrutura de pacotes MQTT-SN do tipo WILL MESSAGE. </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adfb1174ee7cff21df2d0afbb6fe2db30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> mqtt_sn_will_topic_send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Envia tópico de LWT. </p>
<p>Envia tópico utilizado quando o dispositivo se desconectar</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Falha ao enviar a mensagem Will MSG </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Sucesso ao enviar a mensagem Will MSG </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                        {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="structwilltopic__packet__t.html">willtopic_packet_t</a> packet;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">size_t</span> topic_name_len = strlen(g_mqtt_sn_con.will_topic);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (topic_name_len &gt; MQTT_SN_MAX_TOPIC_LENGTH) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Erro: Nome do topico WILL excede o limite maximo&quot;</span>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  packet.flags = MQTT_SN_FLAG_RETAIN;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  packet.type = MQTT_SN_TYPE_WILLTOPIC;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  strncpy(packet.will_topic, g_mqtt_sn_con.will_topic, topic_name_len);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  packet.length = 0x03 + topic_name_len;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  packet.will_topic[topic_name_len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Enviando o pacote @WILL TOPIC&quot;</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  simple_udp_send(&amp;g_mqtt_sn_con.udp_con,&amp;packet, packet.length);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="structwilltopic__packet__t_html"><div class="ttname"><a href="structwilltopic__packet__t.html">willtopic_packet_t</a></div><div class="ttdoc">Estrutura de pacotes MQTT-SN do tipo WILL TOPIC. </div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac598f98e844bfd5bbdb577099ddf06d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parse_mqtt_type_string </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>type_string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retorna a string de status correspondente. </p>
<p>Realiza o parsing do estado da conexão MQTT-SN traduzindo de typedef enum para estado em string</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Não recebe argumento </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type_string</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                                             {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_CONNECT:</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      *type_string = <span class="stringliteral">&quot;CONNECT&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_REGISTER:</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      *type_string = <span class="stringliteral">&quot;REGISTER&quot;</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_SUB_WILDCARD:</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      *type_string = <span class="stringliteral">&quot;SUBSCRIBE_WILDCARD&quot;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_PUBLISH:</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      *type_string = <span class="stringliteral">&quot;PUBLISH&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_SUBSCRIBE:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      *type_string = <span class="stringliteral">&quot;SUBSCRIBE&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_PINGREQ:</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      *type_string = <span class="stringliteral">&quot;PINGREQ&quot;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_PINGRESP:</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      *type_string = <span class="stringliteral">&quot;PINGRESP&quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_DISCONNECT:</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      *type_string = <span class="stringliteral">&quot;DISCONNECT&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_WILLTOPIC:</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      *type_string = <span class="stringliteral">&quot;WILL_TOPIC&quot;</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">case</span> MQTT_SN_TYPE_WILLMSG:</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      *type_string = <span class="stringliteral">&quot;WILL_MESSAGE&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      *type_string = <span class="stringliteral">&quot;Estado nao definido nas opcoes&quot;</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6674e1ecf45890d3a15ab667fe4a4f58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_g_topics </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exibe os tópicos registrados. </p>
<p>Exibe a lista de tópicos registrados no broker</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                         {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Vetor de topicos&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">for</span>(i = 0 ; g_topic_bind[i].short_topic_id != 0xFF; i++) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;[i=%d][%d][%s]&quot;</span>,i,g_topic_bind[i].short_topic_id,g_topic_bind[i].topic_name);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9614aca44158215c43b8810e052939d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timeout_con </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processa timeout de pacotes. </p>
<p>Processa toda e qualquer requisição de expiração de tempo por timeout de envio de mensagens (SUBSCRIBE, PUBLISH, REGISTER)</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                           {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="keywordflow">switch</span> (mqtt_status) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_CONNACK:</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="keywordflow">if</span> (g_tries_send &gt;= <a class="code" href="group__MQTT__SN__CONTROL.html#gaad5ac7de3008d8fa37447193aebc31e2">MQTT_SN_RETRY</a>) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        g_tries_send = 0;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        process_post(&amp;mqtt_sn_main,mqtt_event_ping_timeout,NULL);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Limite maximo de pacotes CONNECT&quot;</span>);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Expirou tempo de CONNECT&quot;</span>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <a class="code" href="mqtt__sn_8c.html#a1b8eb51076a2923f2c036f1ff925c168">mqtt_sn_con_send</a>();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        mqtt_status = MQTTSN_WAITING_CONNACK;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        ctimer_reset(&amp;mqtt_time_connect);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        g_tries_send++;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_REGACK:</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">if</span> (g_tries_send &gt;= <a class="code" href="group__MQTT__SN__CONTROL.html#gaad5ac7de3008d8fa37447193aebc31e2">MQTT_SN_RETRY</a>) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        g_tries_send = 0;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        process_post(&amp;mqtt_sn_main,mqtt_event_ping_timeout,NULL);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Limite maximo de pacotes REGISTER&quot;</span>);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Expirou tempo de REGISTER&quot;</span>);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="mqtt__sn_8c.html#ae17664af7f894e29743fafdf8bf98f89">mqtt_sn_reg_send</a>();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        mqtt_status = MQTTSN_WAITING_REGACK;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        ctimer_reset(&amp;mqtt_time_register);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        g_tries_send++;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_SUBACK:</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <span class="keywordflow">if</span> (g_tries_send &gt;= <a class="code" href="group__MQTT__SN__CONTROL.html#gaad5ac7de3008d8fa37447193aebc31e2">MQTT_SN_RETRY</a>) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        g_tries_send = 0;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        process_post(&amp;mqtt_sn_main,mqtt_event_ping_timeout,NULL);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Limite maximo de pacotes SUBSCRIBE&quot;</span>);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Expirou tempo de SUBSCRIBE&quot;</span>);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <a class="code" href="mqtt__sn_8c.html#a105b8d440266b4a582f2d627e57be14a">mqtt_sn_sub_send</a>(g_topic_bind[mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">short_topic</a>].topic_name, mqtt_queue_first-&gt;data.<a class="code" href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">qos_level</a>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        mqtt_status = MQTTSN_WAITING_SUBACK;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        ctimer_reset(&amp;mqtt_time_subscribe);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        g_tries_send++;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">case</span> MQTTSN_WAITING_WILLTOPICREQ:</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">if</span> (g_tries_send &gt;= <a class="code" href="group__MQTT__SN__CONTROL.html#gaad5ac7de3008d8fa37447193aebc31e2">MQTT_SN_RETRY</a>) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        g_tries_send = 0;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        process_post(&amp;mqtt_sn_main,mqtt_event_ping_timeout,NULL);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Limite maximo de pacotes CONNECT para WILL TOPIC&quot;</span>);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        debug_mqtt(<span class="stringliteral">&quot;Expirou tempo de CONNECT para WILL TOPIC&quot;</span>);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <a class="code" href="mqtt__sn_8c.html#a1b8eb51076a2923f2c036f1ff925c168">mqtt_sn_con_send</a>();</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        mqtt_status = MQTTSN_WAITING_WILLTOPICREQ;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        ctimer_reset(&amp;mqtt_time_connect);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        g_tries_send++;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">case</span> MQTTSN_CONNECTED:</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="comment">//process_post(&amp;mqtt_sn_main, mqtt_event_run_task, NULL);</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      debug_mqtt(<span class="stringliteral">&quot;Expirou tempo de estado desconhecido&quot;</span>);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8c_html_ae17664af7f894e29743fafdf8bf98f89"><div class="ttname"><a href="mqtt__sn_8c.html#ae17664af7f894e29743fafdf8bf98f89">mqtt_sn_reg_send</a></div><div class="ttdeci">resp_con_t mqtt_sn_reg_send(void)</div><div class="ttdoc">Envio de mensagens ao broker do tipo REGISTER. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:444</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a1b8eb51076a2923f2c036f1ff925c168"><div class="ttname"><a href="mqtt__sn_8c.html#a1b8eb51076a2923f2c036f1ff925c168">mqtt_sn_con_send</a></div><div class="ttdeci">resp_con_t mqtt_sn_con_send(void)</div><div class="ttdoc">Envia requisição de conexão ao broker MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:422</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_gaad5ac7de3008d8fa37447193aebc31e2"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#gaad5ac7de3008d8fa37447193aebc31e2">MQTT_SN_RETRY</a></div><div class="ttdeci">#define MQTT_SN_RETRY</div><div class="ttdoc">Número de tentativas de enviar qualquer pacote ao broker antes de desconectar. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:154</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a5ce109928f26d01872230443c75c91f8"><div class="ttname"><a href="structmqtt__sn__task__t.html#a5ce109928f26d01872230443c75c91f8">mqtt_sn_task_t::qos_level</a></div><div class="ttdeci">uint8_t qos_level</div><div class="ttdoc">Nível QoS da tarefa a ser alocada na pilha. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:379</div></div>
<div class="ttc" id="mqtt__sn_8c_html_a105b8d440266b4a582f2d627e57be14a"><div class="ttname"><a href="mqtt__sn_8c.html#a105b8d440266b4a582f2d627e57be14a">mqtt_sn_sub_send</a></div><div class="ttdeci">resp_con_t mqtt_sn_sub_send(char *topic, uint8_t qos)</div><div class="ttdoc">Envia pacote SUBSCRIBE ao broker MQTT-SN. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:553</div></div>
<div class="ttc" id="structmqtt__sn__task__t_html_a25bc8ea535927589bca3720e0e838958"><div class="ttname"><a href="structmqtt__sn__task__t.html#a25bc8ea535927589bca3720e0e838958">mqtt_sn_task_t::short_topic</a></div><div class="ttdeci">uint8_t short_topic</div><div class="ttdoc">Tópico curto ou topic id a ser publicado/inscrito. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:377</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a35dbd49b5fdc1d6e3dfe2b2d7255cf3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timeout_ping_mqtt </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processa timeout de ping. </p>
<p>Processa toda expiração de tempo por timeout de envio de mensagens PINGREQ</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Não retorna nada </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                 {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="comment">//debug_mqtt(&quot;\nTentativas PING:%d&quot;,g_tries_ping);</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordflow">if</span> (g_ping_flag_resp) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    g_ping_flag_resp = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    g_tries_ping = 0;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="comment">//debug_mqtt(&quot;Enviando PING REQUEST&quot;);</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="mqtt__sn_8c.html#af09083ea59a182fdf109b6e3fa213bec">mqtt_sn_ping_send</a>();</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (g_tries_ping &gt;= <a class="code" href="group__MQTT__SN__CONTROL.html#ga180af20d177732dc470c147452feb30f">MQTT_SN_RETRY_PING</a>) {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      g_tries_ping = 0;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      ctimer_stop(&amp;mqtt_time_ping);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordflow">if</span> (mqtt_status != MQTTSN_DISCONNECTED)</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        process_post(&amp;mqtt_sn_main,mqtt_event_ping_timeout,NULL);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      debug_mqtt(<span class="stringliteral">&quot;Limite tentativas de PING RESPONSE&quot;</span>);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      debug_mqtt(<span class="stringliteral">&quot;INCREMENTANDO PING&quot;</span>);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      <a class="code" href="mqtt__sn_8c.html#af09083ea59a182fdf109b6e3fa213bec">mqtt_sn_ping_send</a>();</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      g_tries_ping++;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  ctimer_reset(&amp;mqtt_time_ping);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;}</div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga180af20d177732dc470c147452feb30f"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga180af20d177732dc470c147452feb30f">MQTT_SN_RETRY_PING</a></div><div class="ttdeci">#define MQTT_SN_RETRY_PING</div><div class="ttdoc">Número de tentativas de envio de PING REQUEST antes de desconectar nó <-> broker. ...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:151</div></div>
<div class="ttc" id="mqtt__sn_8c_html_af09083ea59a182fdf109b6e3fa213bec"><div class="ttname"><a href="mqtt__sn_8c.html#af09083ea59a182fdf109b6e3fa213bec">mqtt_sn_ping_send</a></div><div class="ttdeci">void mqtt_sn_ping_send(void)</div><div class="ttdoc">Envia requisição de ping ao broker. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.c:410</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2620f37584b501fde35e71806a78b35a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool unlock_tasks </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Libera opção de geração de tarefas. </p>
<p>Habilita a geração de tarefas na fila conforma o estado da conexão MQTT-SN</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">0</td><td>Não recebe argumento</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>Pode-se gerar tarefa na fila </td></tr>
    <tr><td class="paramname">FALSE</td><td>Estado da conexão MQTT-SN impossibilita geração de tarefas na fila </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                        {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (mqtt_status == MQTTSN_TOPIC_REGISTERED)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af60c0aa848adffbfe41a2e655a279f9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> verf_hist_sub </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifica se o tópico já foi registrado. </p>
<p>Verifica se o tópico em análise já foi previamente registrado ou está em processo de registro</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser inscrito (deve estar pré-listado e passado como argumento em mqtt_sn_create_sck)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Tópico já foi registrado ou está em andamento </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Tópico liberado para inscrição </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                     {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// for (i=0; i &lt; MAX_TOPIC_USED; i++)</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">//   if(strcmp(g_topic_bind[i].topic_name,topic) == 0) // Tópico novo ou existe?</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">//     break;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// if (g_topic_bind[i].short_topic_id == 0xFF) {</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">//   debug_mqtt(&quot;Topico nao registrado!&quot;)</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">//   return FAIL_CON;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// }</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span>(strcmp(g_topic_bind[i].topic_name,topic) == 0)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordflow">if</span> (g_topic_bind[i].subscribed == 0x01){  <span class="comment">// Na fila para inscrever? 0x01?</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Inscricao do topico em andamento:[%s]&quot;</span>,g_topic_bind[i].topic_name);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (g_topic_bind[i].subscribed == 0x02) {  <span class="comment">// Já inscrito? 0x02?</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Topico inscrito:[%s]&quot;</span>,g_topic_bind[i].topic_name);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (g_topic_bind[i].subscribed == 0x00){  <span class="comment">// Caso g_topic_bind[i].subscribed == 0x00 vamos preparar o topico para ser inscrito</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    g_topic_bind[i].subscribed = 0x01;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Preparando para inscricao:[%s]&quot;</span>,g_topic_bind[i].topic_name);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    debug_mqtt(<span class="stringliteral">&quot;Topico com valor estranho no SUBSCRIBED:%d&quot;</span>,g_topic_bind[i].subscribed);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac81a0d1e0daa51cdb8495a52e317e140"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="mqtt__sn_8h.html#add91ba4199db8665b9b9fc56fc6783a6">resp_con_t</a> verf_register </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifica pré-registro do tópico. </p>
<p>Verifica se o tópico já foi pré-registrado antes de iniciar qualquer operação</p>
<dl class="params"><dt>Parâmetros</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">topic</td><td>Tópico a ser verificado</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Valores retornados</dt><dd>
  <table class="retval">
    <tr><td class="paramname">FAIL_CON</td><td>Tópico não foi pré-registrado </td></tr>
    <tr><td class="paramname">SUCCESS_CON</td><td>Tópico registrado no vetor de tópicos </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                     {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">for</span> (i=0; i &lt; <a class="code" href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a>; i++)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span>(strcmp(g_topic_bind[i].topic_name,topic) == 0)  <span class="comment">// Tópico novo ou existe?</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  debug_mqtt(<span class="stringliteral">&quot;Topico nao registrado!&quot;</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;}</div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ac6ae922662cbaf7958eb387bfd6fe4da">FAIL_CON</a></div><div class="ttdoc">Erro ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:404</div></div>
<div class="ttc" id="mqtt__sn_8h_html_a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f"><div class="ttname"><a href="mqtt__sn_8h.html#a754c1055b4431040415cf01b39caaa98ae7b7a388c90c2c5428cced225760885f">SUCCESS_CON</a></div><div class="ttdoc">Sucesso ao processar algo. </div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:405</div></div>
<div class="ttc" id="group__MQTT__SN__CONTROL_html_ga5ed98e8fc00194886ebc14d25540f81b"><div class="ttname"><a href="group__MQTT__SN__CONTROL.html#ga5ed98e8fc00194886ebc14d25540f81b">MAX_TOPIC_USED</a></div><div class="ttdeci">#define MAX_TOPIC_USED</div><div class="ttdoc">Número máximo de tópicos que o usuário pode registrar, a API cria um conjunto de estruturas para o bi...</div><div class="ttdef"><b>Definition:</b> mqtt_sn.h:156</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Gerado em Domingo, 4 de Setembro de 2016 20:34:38 para MQTT-SN_Contiki por &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
